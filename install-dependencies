#!/bin/bash

# Copyright (C) 2017 Andrew Hamilton. All rights reserved.
# Licensed under the Artistic License 2.0.


set -e


DIST_ID=$(cat /etc/os-release | grep "^ID=" | cut -d "=" -f 2)
if [ $DIST_ID == "fedora" ]; then
    INSTALL_CMD="dnf -y install"
    DEPS="python3-distro python3-inotify python3-pygments python3-docopt python3-pillow"
elif [ $DIST_ID == "arch" ]; then
    INSTALL_CMD="pacman -S --noconfirm --needed"
    DEPS="python-pyinotify python-pygments python-docopt python-pillow"
    sudo pacman -S --noconfirm python-pip
    sudo pip3 install distro
elif [ $DIST_ID == "opensuse" ]; then
    INSTALL_CMD="zypper -n install"
    DEPS="python3-pyinotify python3-Pygments python3-docopt python3-Pillow"
    sudo pip3 install distro
elif [ $DIST_ID == "debian" ]; then
    INSTALL_CMD="apt --yes install"
    DEPS="python3-pyinotify python3-pygments python3-docopt python3-pillow"
    sudo apt --yes install python3-pip
    sudo pip3 install distro
elif [ $DIST_ID == "gentoo" ]; then
    INSTALL_CMD="emerge --noreplace"
    DEPS="pyinotify pygments docopt pillow"
    emerge --noreplace dev-python/pip
    sudo pip3 install --user distro
else
    INSTALL_CMD="apt --yes install"
    DEPS="python3-distro python3-pyinotify python3-pygments python3-docopt python3-pillow"
fi
echo "Installing the dependencies of the vigil script..."
sudo $INSTALL_CMD $DEPS util-linux
echo
echo "Installing all the tools vigil may need..."
./install-tools
